---
title: "R Notebook"
output: 
  html_notebook:
    code_folding: hide
  
---

### Filename Scraping

Firstly, we want to start by noting all csv files contained within the `./data_output` directory,
and list them all out. Then, we want to parse out the p, alpha, N, and dim variables from the 
csv name. Finally, we want to add all of this to a dataframe, let's call it df.

```{r datainput}
library(readr)
library(dplyr)

filenames <- list.files("./data_output", pattern="*.csv", full.names=TRUE)
stripped_filenames <- substr(filenames,19, nchar(filenames)-4)
split_strip_filenames <- strsplit(stripped_filenames, "_")
seq <- seq_along(filenames)

temp <- 2
getelt <- function(x) {
  list_temp <- split_strip_filenames[[x]]
  return(split_strip_filenames[[x]][temp])
}

pvector <- lapply(seq, getelt)
temp <- 4
avector <- lapply(seq, getelt)
temp <- 6
nvector <- lapply(seq, getelt)
temp <- 8
dvector <- lapply(seq, getelt)
df <- data_frame(p = as.numeric(pvector),
           alpha = as.numeric(avector),
           N = as.integer(nvector),
           dim = as.integer(dvector),
           filename = filenames)
rm(pvector, avector, nvector, dvector, temp, split_strip_filenames, filenames, stripped_filenames, getelt)
```

### Data Loading + Graphing

NOTE: Should add a box and whisker plot at the end of this, potentially in addition
to this graph (which would only really be illustrative for debugging purposes)
```{r, message=FALSE}
library(ggplot2)
library(readr)
filename <- df$filename[13]
p <- df$p[13]
alpha <- df$alpha[13]
N <- df$N[13]
dim <- df$N[13]
data <- read_csv(filename)
seq <- seq_along(data$`lengthOfPathk=1`)
data$seq <- seq
alphaval <- 0.1
ggplot(data, aes(x=seq)) +
  geom_point(aes(y=data$`lengthOfPathk=1`), color="red", alpha = alphaval, position=position_jitter()) +  
  geom_point(aes(y=data$`lengthOfPathk=2`), color="blue", alpha = alphaval, position=position_jitter()) +
  geom_point(aes(y=data$lengthOfShortestPath), color="green", alpha = alphaval, position=position_jitter())
```
```{r}

numMax <- max(data$lengthOfShortestPath, data$`lengthOfPathk=1`,
              data$`lengthOfPathk=2`)




sp.table <- table(factor(data$lengthOfShortestPath, levels=0:numMax))
sp.table <- as_data_frame(sp.table)
sp.table <- rename(sp.table, count=Var1)
sp.table <- mutate(sp.table, label="SP")

k1.table <- table(factor(data$`lengthOfPathk=1`, levels=0:numMax))
k1.table <- as_data_frame(k1.table)
k1.table <- rename(k1.table, count=Var1)
k1.table <- mutate(k1.table, label="k=1")

k2.table <- table(factor(data$`lengthOfPathk=2`, levels=0:numMax))
k2.table <- as_data_frame(k2.table)
k2.table <- rename(k2.table, count=Var1)
k2.table <- mutate(k2.table, label="k=2")

total_ds <- rbind(sp.table, k1.table, k2.table)

ggplot(total_ds, aes(y=n, x=count)) + geom_point(aes(color=label))
```
ToADD: Histogram plots, and the plot that Shai wanted to begin with, IE alpha 
vs average shortest path for greedy and not so greedy.


```{r, warning=FALSE}
zoom <- 50
ggplot(data, aes(`lengthOfPathk=1`), color="black") + geom_freqpoly(bins=zoom) + 
  geom_freqpoly(aes(data$`lengthOfPathk=2`), color="red", bins=zoom) +
  geom_freqpoly(aes(data$lengthOfShortestPath), color="blue",bins=zoom) +
  xlab("Length of Routed Path") + ylab("Frequency") +
  labs(title="Path Length Frequency", 
       subtitle=paste("For p =", p, ", alpha=",alpha,", N=",N,", dim=",dim, sep="")) + xlim(0,NA)
```

